[2023-07-17 16:23:12,344] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [queued]>
[2023-07-17 16:23:12,368] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [queued]>
[2023-07-17 16:23:12,369] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-07-17 16:23:12,369] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-07-17 16:23:12,369] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-07-17 16:23:12,441] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): GOOG> on 2023-05-30 00:00:00+00:00
[2023-07-17 16:23:12,484] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'GOOG', 'scheduled__2023-05-30T00:00:00+00:00', '--job-id', '134', '--raw', '--subdir', 'DAGS_FOLDER/get_stocks.py', '--cfg-path', '/tmp/tmp0zuhhet0', '--error-file', '/tmp/tmp0yz4bp7y']
[2023-07-17 16:23:12,486] {standard_task_runner.py:80} INFO - Job 134: Subtask GOOG
[2023-07-17 16:23:12,447] {standard_task_runner.py:52} INFO - Started process 9258 to run task
[2023-07-17 16:23:12,746] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [running]> on host lucas-Estudos
[2023-07-17 16:23:12,988] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=GOOG
AIRFLOW_CTX_EXECUTION_DATE=2023-05-30T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-05-30T00:00:00+00:00
[2023-07-17 16:23:13,959] {base.py:297} ERROR - GOOG: No price data found, symbol may be delisted (1h 2023-05-29 -> 2023-05-30)
[2023-07-17 16:23:13,963] {python.py:173} INFO - Done. Returned value was: None
[2023-07-17 16:23:14,033] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=GOOG, execution_date=20230530T000000, start_date=20230717T192312, end_date=20230717T192314
[2023-07-17 16:23:14,072] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-07-17 16:23:14,290] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-07-17 16:54:29,535] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [queued]>
[2023-07-17 16:54:29,555] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [queued]>
[2023-07-17 16:54:29,555] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-07-17 16:54:29,555] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-07-17 16:54:29,555] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-07-17 16:54:29,619] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): GOOG> on 2023-05-30 00:00:00+00:00
[2023-07-17 16:54:29,631] {standard_task_runner.py:52} INFO - Started process 21871 to run task
[2023-07-17 16:54:29,668] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'GOOG', 'scheduled__2023-05-30T00:00:00+00:00', '--job-id', '353', '--raw', '--subdir', 'DAGS_FOLDER/get_stocks.py', '--cfg-path', '/tmp/tmpcmcre74w', '--error-file', '/tmp/tmplmxjnam0']
[2023-07-17 16:54:29,670] {standard_task_runner.py:80} INFO - Job 353: Subtask GOOG
[2023-07-17 16:54:29,829] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [running]> on host lucas-Estudos
[2023-07-17 16:54:29,962] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=GOOG
AIRFLOW_CTX_EXECUTION_DATE=2023-05-30T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-05-30T00:00:00+00:00
[2023-07-17 16:54:30,415] {base.py:297} ERROR - GOOG: No price data found, symbol may be delisted (1h 2023-05-29 -> 2023-05-30)
[2023-07-17 16:54:30,421] {python.py:173} INFO - Done. Returned value was: None
[2023-07-17 16:54:30,488] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=GOOG, execution_date=20230530T000000, start_date=20230717T195429, end_date=20230717T195430
[2023-07-17 16:54:30,557] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-07-17 16:54:30,780] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-07-17 21:01:27,856] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [queued]>
[2023-07-17 21:01:27,863] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [queued]>
[2023-07-17 21:01:27,863] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-07-17 21:01:27,863] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-07-17 21:01:27,863] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-07-17 21:01:27,873] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): GOOG> on 2023-05-30 00:00:00+00:00
[2023-07-17 21:01:27,876] {standard_task_runner.py:52} INFO - Started process 22220 to run task
[2023-07-17 21:01:27,879] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'GOOG', 'scheduled__2023-05-30T00:00:00+00:00', '--job-id', '570', '--raw', '--subdir', 'DAGS_FOLDER/get_stocks.py', '--cfg-path', '/tmp/tmptn8brb4x', '--error-file', '/tmp/tmpg99zcwmc']
[2023-07-17 21:01:27,879] {standard_task_runner.py:80} INFO - Job 570: Subtask GOOG
[2023-07-17 21:01:27,949] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [running]> on host lucas-Estudos
[2023-07-17 21:01:28,170] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=GOOG
AIRFLOW_CTX_EXECUTION_DATE=2023-05-30T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-05-30T00:00:00+00:00
[2023-07-17 21:01:30,796] {base.py:297} ERROR - GOOG: No price data found, symbol may be delisted (1h 2023-05-29 -> 2023-05-30)
[2023-07-17 21:01:30,802] {python.py:173} INFO - Done. Returned value was: None
[2023-07-17 21:01:30,854] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=GOOG, execution_date=20230530T000000, start_date=20230718T000127, end_date=20230718T000130
[2023-07-17 21:01:30,902] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-07-17 21:01:31,020] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-07-17 22:03:42,150] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [queued]>
[2023-07-17 22:03:42,165] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [queued]>
[2023-07-17 22:03:42,165] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-07-17 22:03:42,165] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-07-17 22:03:42,165] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-07-17 22:03:42,183] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): GOOG> on 2023-05-30 00:00:00+00:00
[2023-07-17 22:03:42,191] {standard_task_runner.py:52} INFO - Started process 65497 to run task
[2023-07-17 22:03:42,202] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'GOOG', 'scheduled__2023-05-30T00:00:00+00:00', '--job-id', '878', '--raw', '--subdir', 'DAGS_FOLDER/get_stocks.py', '--cfg-path', '/tmp/tmp4lhd5wzy', '--error-file', '/tmp/tmpkwbu4rf_']
[2023-07-17 22:03:42,204] {standard_task_runner.py:80} INFO - Job 878: Subtask GOOG
[2023-07-17 22:03:42,304] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [running]> on host lucas-Estudos
[2023-07-17 22:03:42,386] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=GOOG
AIRFLOW_CTX_EXECUTION_DATE=2023-05-30T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-05-30T00:00:00+00:00
[2023-07-17 22:03:45,004] {base.py:297} ERROR - GOOG: No price data found, symbol may be delisted (1h 2023-05-29 -> 2023-05-30)
[2023-07-17 22:03:45,014] {python.py:173} INFO - Done. Returned value was: None
[2023-07-17 22:03:45,068] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=GOOG, execution_date=20230530T000000, start_date=20230718T010342, end_date=20230718T010345
[2023-07-17 22:03:45,141] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-07-17 22:03:45,287] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-07-18 10:43:00,408] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [queued]>
[2023-07-18 10:43:00,436] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [queued]>
[2023-07-18 10:43:00,437] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-07-18 10:43:00,437] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-07-18 10:43:00,437] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-07-18 10:43:00,472] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): GOOG> on 2023-05-30 00:00:00+00:00
[2023-07-18 10:43:00,483] {standard_task_runner.py:52} INFO - Started process 16234 to run task
[2023-07-18 10:43:00,488] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'GOOG', 'scheduled__2023-05-30T00:00:00+00:00', '--job-id', '1353', '--raw', '--subdir', 'DAGS_FOLDER/get_stocks.py', '--cfg-path', '/tmp/tmperxkgimp', '--error-file', '/tmp/tmpfbzcpk6y']
[2023-07-18 10:43:00,490] {standard_task_runner.py:80} INFO - Job 1353: Subtask GOOG
[2023-07-18 10:43:00,561] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.GOOG scheduled__2023-05-30T00:00:00+00:00 [running]> on host lucas-Estudos
[2023-07-18 10:43:00,644] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=GOOG
AIRFLOW_CTX_EXECUTION_DATE=2023-05-30T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-05-30T00:00:00+00:00
[2023-07-18 10:43:01,144] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/lucas/.local/lib/python3.10/site-packages/airflow/decorators/base.py", line 179, in execute
    return_value = super().execute(context)
  File "/home/lucas/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/lucas/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/lucas/Área de Trabalho/Alura/EngenhariaDados/3-Executores do Airflow/Local and Celery/airflow_pipeline/dags/get_stocks.py", line 19, in get_history
    yfinance.Ticker(ticker).history(
  File "/home/lucas/.local/lib/python3.10/site-packages/yfinance/utils.py", line 105, in wrapper
    result = func(*args, **kwargs)
  File "/home/lucas/.local/lib/python3.10/site-packages/yfinance/base.py", line 299, in history
    logger.debug(f'{self.ticker}: yfinance received OHLC data: {quotes.index[0]} -> {quotes.index[-1]}')
  File "/home/lucas/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 5175, in __getitem__
    return getitem(key)
  File "/home/lucas/.local/lib/python3.10/site-packages/pandas/core/arrays/datetimelike.py", line 370, in __getitem__
    "Union[DatetimeLikeArrayT, DTScalarOrNaT]", super().__getitem__(key)
  File "/home/lucas/.local/lib/python3.10/site-packages/pandas/core/arrays/_mixins.py", line 272, in __getitem__
    result = self._ndarray[key]
IndexError: index 0 is out of bounds for axis 0 with size 0
[2023-07-18 10:43:01,186] {taskinstance.py:1395} INFO - Marking task as FAILED. dag_id=get_stocks_dag, task_id=GOOG, execution_date=20230530T000000, start_date=20230718T134300, end_date=20230718T134301
[2023-07-18 10:43:01,207] {standard_task_runner.py:92} ERROR - Failed to execute job 1353 for task GOOG (index 0 is out of bounds for axis 0 with size 0; 16234)
[2023-07-18 10:43:01,222] {local_task_job.py:156} INFO - Task exited with return code 1
[2023-07-18 10:43:01,314] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
